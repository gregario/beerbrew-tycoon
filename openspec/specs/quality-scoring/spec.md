## ADDED Requirements

### Requirement: Quality score is calculated from four components
The system SHALL calculate a final quality score (0.0–100.0) as a weighted combination of four components: (1) Flavor/Technique ratio match vs. the selected style's ideal ratio, (2) ingredient-style compatibility, (3) novelty modifier based on recipe history, and (4) a base score derived from total points generated by sliders.

#### Scenario: All components contribute to final score
- **WHEN** a brew is completed
- **THEN** the quality score reflects contributions from ratio match, ingredient compatibility, novelty, and slider effort

### Requirement: Flavor/Technique ratio match is the primary quality driver
The system SHALL weight the ratio match component most heavily (approximately 50% of the total score). The closer the player's Flavor/Technique ratio is to the style's ideal, the higher this component scores.

#### Scenario: Ideal ratio produces high ratio score
- **WHEN** the total Flavor/Technique ratio from sliders matches the style's ideal within ±5%
- **THEN** the ratio component score SHALL be ≥ 90 (out of 100 for that component)

#### Scenario: Poor ratio produces low ratio score
- **WHEN** the total Flavor/Technique ratio deviates from the style's ideal by more than 30%
- **THEN** the ratio component score SHALL be ≤ 40 (out of 100 for that component)

### Requirement: Ingredient compatibility modifies the base score
The system SHALL apply ingredient compatibility modifiers from the selected recipe. Ingredients that are a poor match for the chosen style SHALL apply a negative multiplier; well-matched ingredients SHALL apply a positive multiplier.

#### Scenario: Good ingredient match improves score
- **WHEN** all three ingredients have high compatibility with the chosen style
- **THEN** the ingredient component applies a positive modifier to the final score

#### Scenario: Poor ingredient match reduces score
- **WHEN** one or more ingredients have low compatibility with the chosen style
- **THEN** the ingredient component applies a negative modifier to the final score

### Requirement: Novelty modifier decreases on recipe repetition
The system SHALL apply a novelty modifier that starts at 1.0 for a new recipe combination and decreases by a configurable amount (default: −0.15 per repeat) each time the exact same style + ingredient combination is brewed. The novelty modifier SHALL have a floor of 0.4 (40% of original novelty contribution).

#### Scenario: First brew of a recipe has full novelty
- **WHEN** a recipe combination has never been brewed before in this run
- **THEN** the novelty modifier is 1.0

#### Scenario: Repeated recipe incurs novelty penalty
- **WHEN** the player brews the same recipe for the third time
- **THEN** the novelty modifier is 0.7 (1.0 − 2 × 0.15)

#### Scenario: Novelty penalty is floored
- **WHEN** the player has brewed the same recipe many times such that the calculated modifier would fall below 0.4
- **THEN** the novelty modifier is clamped to 0.4

### Requirement: Quality score breakdown is available for display
The system SHALL produce a score breakdown object alongside the final score, containing each component's contribution. The results UI SHALL use this breakdown to display a score explanation to the player.

#### Scenario: Breakdown data is available post-brew
- **WHEN** quality calculation completes
- **THEN** the returned result includes the final score and labeled sub-scores for each component
